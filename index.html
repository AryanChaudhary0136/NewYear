<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>New Year Story</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&family=Cinzel:wght@600&family=Playfair+Display:ital,wght@1,500&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
:root { --gold:#f5c542; }
*{ box-sizing:border-box; }

body{
  margin:0;
  min-height:100vh;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:Poppins,sans-serif;
}

.app{
  width:100%;
  max-width:420px;
  color:#fff;
}

/* STORY */
.story{
  position:relative;
  width:100%;
  aspect-ratio:9/16;
  border-radius:18px;
  overflow:hidden;
  background:url("bgnw.jpg") center/cover no-repeat;
  box-shadow:0 20px 40px rgba(0,0,0,.6);
}

/* Overlay */
.story::before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(
    to bottom,
    rgba(0,0,0,.25),
    rgba(0,0,0,.65)
  );
  z-index:1;
}

/* Canvas */
#fw{
  position:absolute;
  inset:0;
  z-index:2;
  pointer-events:none;
}

/* CONTENT */
.content{
  position:relative;
  z-index:3;
  height:100%;
  padding:20px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
}

/* USER IMAGE */
.photo{
  width:min(60vw,220px);
  height:min(60vw,220px);
  border-radius:18px;
  background:rgba(255,255,255,.08);
  border:3px solid var(--gold);
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}

.photo img{
  width:100%;
  height:100%;
  object-fit:contain;
  background:#000;
}

/* TEXT */
.text{
  text-align:center;
  margin-top:22px;
}

.text h1{
  margin:0;
  font-family:'Cinzel', serif;
  font-size:clamp(26px,6vw,38px);
  letter-spacing:2px;
  color:var(--gold);
  text-shadow:0 2px 8px rgba(0,0,0,0.6);
}

.quote{
  margin-top:12px;
  font-family:'Playfair Display',serif;
  font-size:clamp(16px,4.5vw,22px);
  font-style:italic;
  line-height:1.4;
}

.name{
  margin-top:12px;
  font-weight:600;
}

/* CONTROLS */
.controls{
  margin-top:14px;
  padding:14px;
  background:rgba(255,255,255,.06);
  border-radius:14px;
}

.controls input,
.controls select,
.controls button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:8px;
  border:none;
  font-size:15px;
}

.controls input[type=file]{ background:#fff; }

.controls button{
  background:var(--gold);
  font-weight:600;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="app">

  <div class="story" id="story">
    <canvas id="fw"></canvas>

    <div class="content">
      <div class="photo">
        <img id="preview" alt="preview">
      </div>

      <div class="text">
        <h1>New Year 2026</h1>
        <div class="quote" id="quoteText"></div>
        <div class="name" id="nameText"></div>
      </div>
    </div>
  </div>

  <div class="controls">
    <!-- ✅ DEPLOY SAFE IMAGE INPUT -->
    <input type="file" accept="image/*" onchange="handleImageUpload(event)">

    <input type="text" placeholder="Enter your name"
      oninput="document.getElementById('nameText').innerText=this.value ? '— ' + this.value : ''">

    <select id="quoteSelect" onchange="updateQuote()"></select>

    <button onclick="download()">Download Story</button>
  </div>

</div>

<audio id="sound" src="crackers.mp3" preload="auto"></audio>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
/* ================= IMAGE UPLOAD (DEPLOY SAFE) ================= */
function handleImageUpload(event){
  const file = event.target.files[0];
  if(!file) return;

  const img = document.getElementById("preview");
  const reader = new FileReader();

  reader.onload = function(e){
    img.src = e.target.result;
  };
  reader.readAsDataURL(file);
}

/* ================= QUOTES ================= */
const quotes = [
  "New year, new mindset, new results.",
  "A fresh year is a fresh chance to become unstoppable.",
  "Leave the past. Build the future.",
  "365 new chances start now.",
  "Turn your dreams into plans this year.",
  "This year, bet on yourself.",
  "Build habits today that future you will thank for.",
  "Progress over perfection.",
  "Dream big. Start small. Act daily."
];

const qs = document.getElementById("quoteSelect");
const qt = document.getElementById("quoteText");

quotes.forEach(q=>{
  const o=document.createElement("option");
  o.value=q; o.textContent=q;
  qs.appendChild(o);
});

const def = quotes[Math.floor(Math.random()*quotes.length)];
qs.value = def;
qt.innerText = def;

function updateQuote(){
  qt.innerText = qs.value;
}

/* ================= FIREWORKS (ROCKET + BURST) ================= */
const canvas = document.getElementById("fw");
const ctx = canvas.getContext("2d");
let rockets=[], particles=[];
const colors=["#ffd700","#ff5252","#4caf50","#40c4ff","#e040fb"];

function resize(){
  canvas.width = story.clientWidth;
  canvas.height = story.clientHeight;
}
window.addEventListener("resize", resize);
resize();

function launchRocket(){
  rockets.push({
    x:Math.random()*canvas.width,
    y:canvas.height,
    vy:-(Math.random()*4+6),
    color:colors[Math.floor(Math.random()*colors.length)]
  });
}

function explode(x,y,color){
  for(let i=0;i<45;i++){
    const a=Math.random()*Math.PI*2;
    const s=Math.random()*4+2;
    particles.push({
      x,y,
      vx:Math.cos(a)*s,
      vy:Math.sin(a)*s,
      life:90,
      color
    });
  }
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  rockets.forEach((r,i)=>{
    r.y+=r.vy;
    ctx.fillStyle=r.color;
    ctx.fillRect(r.x,r.y,2,10);

    if(r.y < canvas.height*0.35){
      explode(r.x,r.y,r.color);
      rockets.splice(i,1);
    }
  });

  particles.forEach((p,i)=>{
    p.x+=p.vx;
    p.y+=p.vy;
    p.vy+=0.04;
    p.life--;

    ctx.beginPath();
    ctx.arc(p.x,p.y,2,0,Math.PI*2);
    ctx.fillStyle=p.color;
    ctx.fill();

    if(p.life<=0) particles.splice(i,1);
  });

  requestAnimationFrame(animate);
}
animate();
setInterval(launchRocket,1800);

/* ================= SOUND ================= */
let played=false;
document.body.addEventListener("click",()=>{
  if(!played){
    sound.play().catch(()=>{});
    played=true;
  }
},{ once:true });

/* ================= DOWNLOAD ================= */
function download(){
  html2canvas(story,{scale:2}).then(c=>{
    const a=document.createElement("a");
    a.href=c.toDataURL("image/png");
    a.download="NewYearStory.png";
    a.click();
  });
}
</script>

</body>
</html><div class="app">

  <div class="story" id="story">
    <canvas id="fw"></canvas>

    <div class="content">
      <div class="photo">
        <img id="preview">
      </div>

      <div class="text">
        <h1>New Year 2026</h1>
        <div class="quote" id="quoteText"></div>
        <div class="name" id="nameText"></div>
      </div>
    </div>
  </div>

  <div class="controls">
    <input type="file" accept="image/*"
      onchange="preview.src=URL.createObjectURL(this.files[0])">

    <input type="text" placeholder="Enter your name"
      oninput="nameText.innerText=this.value?`— ${this.value}`:''">

    <select id="quoteSelect" onchange="updateQuote()"></select>

    <button onclick="download()">Download Story</button>
  </div>

</div>

<audio id="sound" src="crackers.mp3" preload="auto"></audio>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
/* ===== QUOTES ===== */
const quotes=[
  "New year, new mindset, new results.",
  "A fresh year is a fresh chance to become unstoppable.",
  "Leave the past. Build the future.",
  "365 new chances start now.",
  "Turn your dreams into plans this year.",
  "This year, bet on yourself.",
  "Build habits today that future you will thank for.",
  "Progress over perfection.",
  "Dream big. Start small. Act daily."
];

const qs=document.getElementById("quoteSelect");
const qt=document.getElementById("quoteText");

quotes.forEach(q=>{
  const o=document.createElement("option");
  o.value=q;
  o.textContent=q;
  qs.appendChild(o);
});

const def=quotes[Math.floor(Math.random()*quotes.length)];
qs.value=def;
qt.innerText=def;

function updateQuote(){
  qt.innerText=qs.value;
}

/* ===== FIREWORKS (ROCKET + BURST) ===== */
const canvas=document.getElementById("fw");
const ctx=canvas.getContext("2d");
let rockets=[], particles=[];
const colors=["#ffd700","#ff5252","#4caf50","#40c4ff","#e040fb"];

function resize(){
  canvas.width=story.clientWidth;
  canvas.height=story.clientHeight;
}
window.addEventListener("resize",resize);
resize();

function launchRocket(){
  rockets.push({
    x:Math.random()*canvas.width,
    y:canvas.height,
    vy:-(Math.random()*4+6),
    color:colors[Math.floor(Math.random()*colors.length)]
  });
}

function explode(x,y,color){
  for(let i=0;i<45;i++){
    const a=Math.random()*Math.PI*2;
    const s=Math.random()*4+2;
    particles.push({
      x,y,
      vx:Math.cos(a)*s,
      vy:Math.sin(a)*s,
      life:90,
      color
    });
  }
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  rockets.forEach((r,i)=>{
    r.y+=r.vy;
    ctx.fillStyle=r.color;
    ctx.fillRect(r.x,r.y,2,10);

    if(r.y<canvas.height*0.35){
      explode(r.x,r.y,r.color);
      rockets.splice(i,1);
    }
  });

  particles.forEach((p,i)=>{
    p.x+=p.vx;
    p.y+=p.vy;
    p.vy+=0.04;
    p.life--;

    ctx.beginPath();
    ctx.arc(p.x,p.y,2,0,Math.PI*2);
    ctx.fillStyle=p.color;
    ctx.fill();

    if(p.life<=0) particles.splice(i,1);
  });

  requestAnimationFrame(animate);
}
animate();

setInterval(launchRocket,1800);

/* SOUND */
let played=false;
document.body.addEventListener("click",()=>{
  if(!played){
    sound.play().catch(()=>{});
    played=true;
  }
},{once:true});

/* DOWNLOAD */
function download(){
  html2canvas(story,{scale:2}).then(c=>{
    const a=document.createElement("a");
    a.href=c.toDataURL("image/png");
    a.download="NewYearStory.png";
    a.click();
  });
}
</script>

</body>
</html>
