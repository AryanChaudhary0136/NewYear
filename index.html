<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>New Year Story</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600&family=Playfair+Display:ital,wght@1,500&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
:root { --gold:#f5c542; }

*{ box-sizing:border-box; }

body{
  margin:0;
  min-height:100vh;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:Poppins,sans-serif;
}

/* APP */
.app{
  width:100%;
  max-width:420px;
  height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  color:#fff;
}

/* STORY */
.story{
  position:relative;
  width:100%;
  height:100%;
  aspect-ratio:9/16;
  margin:auto;
  border-radius:18px;
  overflow:hidden;
  background:url("bgnw.jpg") center/cover no-repeat;
  box-shadow:0 20px 40px rgba(0,0,0,.6);
}

/* Overlay */
.story::before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(
    to bottom,
    rgba(0,0,0,.25),
    rgba(0,0,0,.65)
  );
  z-index:1;
}

/* Canvas */
#fw{
  position:absolute;
  inset:0;
  z-index:2;
  pointer-events:none;
}

/* CONTENT */
.content{
  position:relative;
  z-index:3;
  height:100%;
  padding:20px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
}

/* IMAGE */
.photo{
  width:min(60vw,220px);
  height:min(60vw,220px);
  border-radius:18px;
  background:rgba(255,255,255,.08);
  border:3px solid var(--gold);
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}

.photo img{
  width:100%;
  height:100%;
  object-fit:contain;
  background:#000;
}

/* TEXT */
.text{
  text-align:center;
  margin-top:22px;
}

.text h1{
  margin:0;
  font-family:'Cinzel',serif;
  font-size:clamp(26px,6vw,38px);
  letter-spacing:2px;
  color:var(--gold);
  text-shadow:0 2px 8px rgba(0,0,0,.6);
}

/* ðŸ”¥ FIX: quote white */
.quote{
  margin-top:12px;
  font-family:'Playfair Display',serif;
  font-size:clamp(16px,4.5vw,22px);
  font-style:italic;
  color:#ffffff;
  line-height:1.4;
}

.name{
  margin-top:12px;
  font-weight:600;
}

/* CONTROLS */
.controls{
  margin-top:10px;
  padding:14px;
  background:rgba(255,255,255,.06);
  border-radius:14px;
}

.controls input,
.controls select,
.controls button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:8px;
  border:none;
  font-size:15px;
}

.controls input[type=file]{ background:#fff; }

.controls button{
  background:var(--gold);
  font-weight:600;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="app">

  <div class="story" id="story">
    <canvas id="fw"></canvas>

    <div class="content">
      <div class="photo">
        <img id="preview">
      </div>

      <div class="text">
        <h1>New Year 2026</h1>
        <div class="quote" id="quoteText"></div>
        <div class="name" id="nameText"></div>
      </div>
    </div>
  </div>

  <div class="controls">
    <input type="file" accept="image/*" id="imageInput">
    <input type="text" placeholder="Enter your name" id="nameInput">
    <select id="quoteSelect"></select>
    <button id="downloadBtn">Download Story</button>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded",()=>{

/* ELEMENTS */
const story=document.getElementById("story");
const preview=document.getElementById("preview");
const nameText=document.getElementById("nameText");
const quoteText=document.getElementById("quoteText");
const quoteSelect=document.getElementById("quoteSelect");
const imageInput=document.getElementById("imageInput");
const nameInput=document.getElementById("nameInput");

/* IMAGE */
imageInput.addEventListener("change",e=>{
  const f=e.target.files[0];
  if(!f) return;
  const r=new FileReader();
  r.onload=ev=>preview.src=ev.target.result;
  r.readAsDataURL(f);
});

/* NAME */
nameInput.addEventListener("input",()=>{
  nameText.textContent=nameInput.value?"â€” "+nameInput.value:"";
});

/* QUOTES */
const quotes=[
  "New year, new mindset, new results.",
  "A fresh year is a fresh chance to become unstoppable.",
  "Leave the past. Build the future.",
  "365 new chances start now.",
  "Turn your dreams into plans this year.",
  "Dream big. Start small. Act daily."
];

quotes.forEach(q=>{
  const o=document.createElement("option");
  o.value=q; o.textContent=q;
  quoteSelect.appendChild(o);
});

quoteSelect.value=quotes[0];
quoteText.textContent=quotes[0];

quoteSelect.addEventListener("change",()=>{
  quoteText.textContent=quoteSelect.value;
});

/* ===== ROCKET + BURST FIREWORKS ===== */
const canvas=document.getElementById("fw");
const ctx=canvas.getContext("2d");
let rockets=[], particles=[];
const colors=["#ffd700","#ff5252","#4caf50","#40c4ff","#e040fb"];

function resizeCanvas(){
  canvas.width=story.clientWidth;
  canvas.height=story.clientHeight;
}
resizeCanvas();
window.addEventListener("resize",resizeCanvas);

function launchRocket(){
  rockets.push({
    x:Math.random()*canvas.width,
    y:canvas.height,
    vy:-(Math.random()*4+6),
    color:colors[Math.floor(Math.random()*colors.length)]
  });
}

function explode(x,y,color){
  for(let i=0;i<45;i++){
    const a=Math.random()*Math.PI*2;
    const s=Math.random()*4+2;
    particles.push({x,y,vx:Math.cos(a)*s,vy:Math.sin(a)*s,life:90,color});
  }
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  rockets.forEach((r,i)=>{
    r.y+=r.vy;
    ctx.fillStyle=r.color;
    ctx.fillRect(r.x,r.y,2,10);
    if(r.y<canvas.height*0.35){
      explode(r.x,r.y,r.color);
      rockets.splice(i,1);
    }
  });

  particles.forEach((p,i)=>{
    p.x+=p.vx;
    p.y+=p.vy;
    p.vy+=0.04;
    p.life--;
    ctx.beginPath();
    ctx.arc(p.x,p.y,2,0,Math.PI*2);
    ctx.fillStyle=p.color;
    ctx.fill();
    if(p.life<=0) particles.splice(i,1);
  });

  requestAnimationFrame(animate);
}
animate();
setInterval(launchRocket,1800);

/* DOWNLOAD */
document.getElementById("downloadBtn").addEventListener("click",()=>{
  html2canvas(story,{scale:2}).then(c=>{
    const a=document.createElement("a");
    a.href=c.toDataURL("image/png");
    a.download="NewYearStory.png";
    a.click();
  });
});

});
</script>

</body>
</html>